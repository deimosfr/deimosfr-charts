# Default values for mealie.
# This is a YAML-formatted file.
# Declare variables to be passed into your templates.

# This will set the replicaset count more information can be found here: https://kubernetes.io/docs/concepts/workloads/controllers/replicaset/
replicaCount: 1

# This sets the update strategy for the StatefulSet.
updateStrategy:
  type: RollingUpdate

# This sets the container image more information can be found here: https://kubernetes.io/docs/concepts/containers/images/
image:
  repository: ghcr.io/mealie-recipes/mealie
  # This sets the pull policy for images.
  pullPolicy: IfNotPresent
  # Overrides the image tag whose default is the chart appVersion.
  tag: ""

# This is for the secrets for pulling an image from a private repository more information can be found here: https://kubernetes.io/docs/tasks/configure-pod-container/pull-image-private-registry/
imagePullSecrets: []
# This is to override the chart name.
nameOverride: ""
fullnameOverride: ""

# This section builds out the service account more information can be found here: https://kubernetes.io/docs/concepts/security/service-accounts/
serviceAccount:
  # Specifies whether a service account should be created.
  create: true
  # Automatically mount a ServiceAccount's API credentials?
  automount: true
  # Annotations to add to the service account.
  annotations: {}
  # The name of the service account to use.
  # If not set and create is true, a name is generated using the fullname template.
  name: ""

# This is for setting Kubernetes Annotations to a Pod.
# For more information checkout: https://kubernetes.io/docs/concepts/overview/working-with-objects/annotations/
podAnnotations: {}
# This is for setting Kubernetes Labels to a Pod.
# For more information checkout: https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/
podLabels: {}

podSecurityContext:
  fsGroup: 2000
  runAsNonRoot: true
  runAsUser: 1000
  runAsGroup: 1000
  seccompProfile:
    type: RuntimeDefault

securityContext:
  capabilities:
    drop:
    - ALL
  readOnlyRootFilesystem: true
  allowPrivilegeEscalation: false

# This is for setting up a service more information can be found here: https://kubernetes.io/docs/concepts/services-networking/service/
service:
  # This sets the service type more information can be found here: https://kubernetes.io/docs/concepts/services-networking/service/#publishing-services-service-types
  type: ClusterIP
  # This sets the ports more information can be found here: https://kubernetes.io/docs/concepts/services-networking/service/#field-spec-ports
  port: 9000

# This block is for setting up the ingress for more information can be found here: https://kubernetes.io/docs/concepts/services-networking/ingress/
ingress:
  enabled: false
  className: ""
  annotations: {}
    # kubernetes.io/ingress.class: nginx
    # kubernetes.io/tls-acme: "true"
  hosts:
    - host: chart-example.local
      paths:
        - path: /
          pathType: ImplementationSpecific
  tls: []
    # - secretName: chart-example-tls
    #   hosts:
    #     - chart-example.local

# -- Expose the service via gateway-api HTTPRoute
# Requires Gateway API resources and suitable controller installed within the cluster
# (see: https://gateway-api.sigs.k8s.io/guides/)
httpRoute:
  # HTTPRoute enabled.
  enabled: false
  # HTTPRoute annotations.
  annotations: {}
  # Which Gateways this Route is attached to.
  parentRefs:
    - name: gateway
      sectionName: http
      # namespace: default
  # Hostnames matching HTTP header.
  # Hostnames matching HTTP header.
  hostnames:
    - chart-example.local

  cors:
    enabled: true
    allowOrigin: "*"
    allowMethods: "GET, POST, OPTIONS, PUT, DELETE"
    allowHeaders: "DNT,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range,Authorization,User-Agent,Keep-Alive"
    exposeHeaders: "Content-Length,Content-Range"
    maxAge: 1728000

  # List of rules and filters applied.
  # rules:
  #   - matches:
  #     - path:
  #         type: PathPrefix
  #         value: /
  #     backendRefs:
  #       - name: my-service
  #         port: 8080

resources: {}
  # We usually recommend not to specify default resources and to leave this as a conscious
  # choice for the user. This also increases chances charts run on environments with little
  # resources, such as Minikube. If you do want to specify resources, uncomment the following
  # lines, adjust them as necessary, and remove the curly braces after 'resources:'.
  # limits:
  #   cpu: 100m
  #   memory: 128Mi
  # requests:
  #   cpu: 100m
  #   memory: 128Mi

# This is to setup the liveness and readiness probes more information can be found here: https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/
livenessProbe:
  initialDelaySeconds: 30
  periodSeconds: 10
  timeoutSeconds: 5
  failureThreshold: 3
  successThreshold: 1
  httpGet:
    path: /
    port: http
readinessProbe:
  initialDelaySeconds: 30
  periodSeconds: 10
  timeoutSeconds: 5
  failureThreshold: 3
  successThreshold: 1
  httpGet:
    path: /
    port: http

# This section is for setting up autoscaling more information can be found here: https://kubernetes.io/docs/concepts/workloads/autoscaling/
# Additional volumes on the output Deployment definition.
volumes: []
  # - name: foo
  #   secret:
  #     secretName: mysecret
  #     optional: false

# Additional volumeMounts on the output Deployment definition.
volumeMounts: []
  # - name: foo
  #   mountPath: "/etc/foo"
  #   readOnly: true

nodeSelector: {}

tolerations: []

affinity: {}

# Mealie specific configuration
mealie:
  # Secrets (will be mounted as environment variables from a Secret)
  # Use this for sensitive data like passwords, API keys, etc.
  secrets: {}
    # POSTGRES_PASSWORD: "securepassword"
    # SMTP_PASSWORD: "securepassword"
    # OIDC_CLIENT_SECRET: "secret"
    # LDAP_BIND_PASSWORD: "secret"
    # OPENAI_API_KEY: "sk-..."

  # General configuration
  # See https://docs.mealie.io/documentation/getting-started/installation/backend-config/
  env:
    # General
    ALLOW_SIGNUP: "true"
    PUID: "1000"
    PGID: "1000"
    TZ: "UTC"
    BASE_URL: "https://mealie.yourdomain.com"
    # MAX_WORKERS: "1"
    # WEB_CONCURRENCY: "1"
    # API_PORT: "9000"

    # Database
    DB_ENGINE: "sqlite" # or postgres
    # POSTGRES_SERVER: ""
    # POSTGRES_PORT: "5432"
    # POSTGRES_DB: "mealie"
    # POSTGRES_USER: "mealie"

    # Email
    # SMTP_HOST: ""
    # SMTP_PORT: ""
    # SMTP_FROM_NAME: "Mealie"
    # SMTP_FROM_EMAIL: "mealie@yourdomain.com"
    # SMTP_AUTH_STRATEGY: "NONE" # or TLS, SSL
    # SMTP_USER: ""

    # Security / Auth
    # TOKEN_TIME: "48" # Hours
    # OIDC_AUTH_ENABLED: "false"
    # OIDC_CONFIGURATION_URL: ""
    # OIDC_CLIENT_ID: ""
    # OIDC_REMEMBER_ME: "true"
    # OIDC_SIGNUP_ENABLED: "true"
    # LDAP_AUTH_ENABLED: "false"
    # LDAP_SERVER_URL: ""
    # LDAP_BIND_DN: ""
    # LDAP_BASE_DN: ""

    # OpenAI
    # OPENAI_MODEL: "gpt-3.5-turbo"

vpa:
  enabled: false
  # updateMode: Auto
  # containerPolicies:
  #   - containerName: "*"
  #     minAllowed:
  #       cpu: 100m
  #       memory: 128Mi
  #     maxAllowed:
  #       cpu: 1000m
  #       memory: 1024Mi

persistence:
  enabled: true
  size: 10Gi
  accessMode: ReadWriteOnce
  storageClass: "" # uses default
